{
  "model": {
    "vocab_size": 50257,
    "block_size": 256,
    "n_layer": 6,
    "n_head": 6,
    "n_embd": 384,
    "dropout": 0.1,
    "bias": false,
    "energy_hidden": 4,
    "use_shared_embeddings": true,
    "mcmc_num_steps": 2,
    "mcmc_step_size": 1.0,
    "mcmc_step_size_learnable": true,
    "langevin_noise": 0.0
  },
  "trainer": {
    "out_dir": "out_ebt_gpt2",
    "seed": 1337,
    "device": "cuda",
    "dtype": "bfloat16",
    "compile": true,
    "batch_size": 32,
    "grad_accum_steps": 1,
    "learning_rate": 0.0003,
    "beta1": 0.9,
    "beta2": 0.95,
    "weight_decay": 0.1,
    "grad_clip": 1.0,
    "decay_lr": true,
    "warmup_iters": 2000,
    "lr_decay_iters": 100000,
    "min_lr": 0.00003,
    "eval_interval": 1000,
    "eval_iters": 50,
    "log_interval": 10
  },
  "data": {
    "dataset": "wikitext-gpt2",
    "data_dir": "data/wikitext-gpt2"
  },
  "thinking": {
    "steps": 8,
    "step_size": 1.0,
    "temperature": 0.8,
    "tau_entropy": 0.2,
    "init": "from_energy"
  }
}

